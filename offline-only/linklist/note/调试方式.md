# 调试方式

1、基于源码调试

2、基于二进制 PC LINUX 调试

3、基于嵌入式的二进制调试

4、基于内核模块的系统调试



要用GDB调试  在GCC编译的时候 ，需要加-g   要不没有符号表



gef  是插件 能看内存，汇编等信息，彩色 好用  安装需要翻墙



## 基于源码的调试

```c++
gdb ./xxx
```



# GDB命令

#### 显示 L l list 

```
l main  显示main函数
```



#### 断点b break  断点

```c
b 25  //25行断点

b init_http    //init_http 执行处 断点
```

#### shell  //返回命令行

#### exit //返回gdb

#### set args  0x10 0x20  //设置参数，给main设置参数

#### run r   //运行起来

#### Next n 下一步  nexti ni 汇编向下走     步入 步过

p/x remote_get  //看 remote_get 的值

vmmap  //显示内存分区地址段

heap   //堆  程序申请的内存 malloc 的内存 new的内存

p *remote_get   //看结构体

x/20wx   20个单位 w word x 16进制形式

x/20gz  

bt 调用栈，查看在几层函数处，深度

infr frame 0  显示第0个栈的信息

 Gdb u跳出
   c 下一断点
  p xxx=225  给变量赋值
set xxx=yy 给变量赋值

段错误会出现core文件



```c
ulimitd unlimited
    ulimitd -a //查看
    ulimitd -c 1024  //设置core 文件大小
```



调试命令gdb xxx core

Readelf -h xxx查看可执行文件的头

# 进程调试

#### 模式  

##### follow-fork-mode  跟踪哪个进程

Set follow-fork-mode   设置  两种模式child parent

show follow-fork-mode   //  显示

##### detach-on-fork  在跟踪时另一进程是否继续运行

set detach-on-fork  在跟踪时另一进程是否继续运行

show detach-on-fork  //两种模式  on off        调试时另一个进程是否运行

``` c
若follow-fork-mode child detach-on-fork on 只调试 子进程
若follow-fork-mode parent detach-on-fork on 只调试 父进程

若follow-fork-mode child detach-on-fork off 调试 子进程   阻塞父进程在fork的断点处
若follow-fork-mode parent detach-on-fork off 调试 父进程   阻塞子进程在fork的断点处
```

##### info inferiors  //显示当前所有进程

##### inferiors num   //切换至指定num的进程  num是上个命令显示的num

![](D:\code\gdb调试相关\微信图片_20210714222100.jpg)  

# 线程调试

info thread 显示线程信息







![](D:\code\gdb调试相关\微信图片_20210714222107.jpg)













linux命令  netstat -aptn  显示网络状态 















##### 待议：

##### 	 attch xxx  //切换到进程 xxx 是PID号

​	//xxx是 子进程的PID号 运行ID 号





























```
## 查看内存 的方式及显示的方式

x/<n/f/u> <addr>

n是一个正整数，表示需要显示的内存单元的个数，也就是说从当前地址向后显示几个内存单元的内容，一个内存单元的大小由后面的u定义。

u 表示从当前地址往后请求的字节数，如果不指定的话，GDB默认是4个bytes。u参数可以用下面的字符来代替，b表示单字节，h表示双字节，w表示四字 节，g表示八字节。当我们指定了字节长度后，GDB会从指内存定的内存地址开始，读写指定字节，并把其当作一个值取出来。

x 按十六进制格式显示变量。

d 按十进制格式显示变量。

u 按十六进制格式显示无符号整型。

o 按八进制格式显示变量。

t 按二进制格式显示变量。

a 按十六进制格式显示变量。

c 按字符格式显示变量。

f 按浮点数格式显示变量。



作者：萍水间人
链接：https://www.jianshu.com/p/62e1b8f8ca9b
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
```



















### gdb 增强插件

 ``` 
 gef插件
 地址 https://github.com/hugsy/gef
 
 安装
 
 # via the install script
 
 #下载 `gef.sh` 并执行
 wget -q -O- https://github.com/hugsy/gef/raw/master/gef.sh | sh
 
 # manually
 
 # 下载 `gef.py`, 并将其 `source` 写入 `.gdbinit`
 
 wget -q -O ~/.gdbinit-gef.py https://github.com/hugsy/gef/raw/master/gef.py
 echo source ~/.gdbinit-gef.py >> ~/.gdbinit
 
 ```

